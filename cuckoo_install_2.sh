#!/bin/bash
#Program: 
# This program is used to install cuckoo 

# Reference site:
# https://cuckoo.sh/docs/installation/host/installation.html
# https://stackoverflow.com/questions/41407396/is-gui-for-android-sdk-manager-gone
# https://github.com/idanr1986/cuckoo-droid/blob/master/README.md

#>>> Install sdk packages
# List all available packages
# ./android list sdk --all
# install packages
echo yes|./android update sdk --no-ui --all --filter 1,2,3,58,150,151,199
cd ~
#cd android-sdk-linux/tools/

#>>> Export path 
export PATH=$PATH:/home/vb/android-sdk-linux/tools:/home/vb/android-sdk-linux/build-tools/28.0.3/:/home/vb/android-sdk-linux/platform-tools
cd ~
cd android-sdk-linux/tools/


# cd bin
# ./sdkmanager
#echo no| ./android create avd -n aosx -t "android-16" -d "Nexus One" --abi default/armeabi-v7a
# ./android delete avd -n aosx
#cd ~/.android/avd/aosx.avd
#rm -r *.avd
#rm *.ini
#### NEED to be modify #### 
##cp -f ~/AndroidMalware/aosx.ini ~/.android/avd/
##cp -fR ~/AndroidMalware/aosx.avd/ ~/.android/avd/
##cd ~
##cp ~/android-sdk-linux/system-images/android-16/default/armeabi-v7a/system.img ~/.android/avd/aosx.avd/system-qemu.img


# update conf files in Cuckoo folder
rm /home/vb/cuckoo/conf/auxiliary.conf
rm /home/vb/cuckoo/conf/avd.conf
rm /home/vb/cuckoo/conf/cuckoo.conf
rm /home/vb/cuckoo/conf/processing.conf
rm /home/vb/cuckoo/conf/reporting.conf
cp ~/AndroidMalware/*.conf /home/vb/cuckoo/conf/

#>>> launch the image
cd ~/android-sdk-linux/tools/
echo yes | sudo pip install pymongo==2.7.2
./emulator -avd aosx -writable-system -qemu -nand system,size=0x1f400000,file=/home/vb/android-sdk-linux/system-images/android-16/default/armeabi-v7a/system.img&
# ./emulator -avd aosx -qemu -nand -system,size=0x1f400000,file="/home/vb/android-sdk-linux/system-images/android-16/default/armeabi-v7a/system.img"&








